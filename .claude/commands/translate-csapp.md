---
description: 翻译 CSAPP 章节文档。将英文原文翻译成中文，保持格式和术语一致性。
argument-hint: <文件路径>
---

# CSAPP 章节翻译命令

## 任务

将文件 `$ARGUMENTS` 的内容翻译成中文。

## 翻译规范

### 1. 术语表（必须严格遵守）

| 英文 | 中文 |
|------|------|
| byte | 字节 |
| bit | 位 |
| word | 字 |
| memory | 内存 |
| cache | 高速缓存 |
| register | 寄存器 |
| stack | 栈 |
| heap | 堆 |
| virtual memory | 虚拟内存 |
| physical memory | 物理内存 |
| address | 地址 |
| pointer | 指针 |
| CPU | CPU |
| processor | 处理器 |
| ALU | 算术逻辑单元 |
| PC | 程序计数器 |
| instruction | 指令 |
| process | 进程 |
| thread | 线程 |
| context switch | 上下文切换 |
| exception | 异常 |
| interrupt | 中断 |
| signal | 信号 |
| compiler | 编译器 |
| assembler | 汇编器 |
| linker | 链接器 |
| loader | 加载器 |
| object file | 目标文件 |
| executable | 可执行文件 |
| file | 文件 |
| descriptor | 描述符 |
| buffer | 缓冲区 |
| stream | 流 |
| socket | 套接字 |
| client | 客户端 |
| server | 服务器 |
| protocol | 协议 |
| concurrency | 并发 |
| parallelism | 并行 |
| mutex | 互斥锁 |
| semaphore | 信号量 |
| deadlock | 死锁 |
| race condition | 竞态条件 |

### 2. 格式保持

- 保留所有 Markdown 格式（标题、列表、代码块、引用等）
- 代码块内容不翻译，保持原样
- 保留图片引用和链接格式
- **数据表不翻译**：表格内容主要由数字、单字母、十六进制值或公式数据组成的表格，保持原样不翻译（如：数值对照表、编码转换表、位运算示例表等）
- LaTeX 公式使用 Markdown 兼容语法：
  - 行内公式：`$...$`（如 `$T_{\text{old}}$`）
  - 块级公式：`$$...$$`
  - 不要使用 `\(` `\)` 或 `\[` `\]` 语法

### 3. 文档分割策略

#### 小文档（≤1000 行）
按标题（`#` 或 `##`）分割，逐部分翻译。

#### 大文档（>1000 行）
当文件超过 1000 行时，执行以下分割流程：

1. **计算分割数量**：`分割数 = min(ceil(总行数 / 1000), 10)`
2. **智能分割点**：在目标行号附近寻找最近的二级标题（`##`）作为分割点，避免在段落中间切割
3. **生成分割文件**：将原文件分割并保存为：
   - `原文件名_part1.md`
   - `原文件名_part2.md`
   - ... 最多到 `_part10.md`
4. **分批翻译**：
   - 每次翻译一个分割文件
   - 翻译完成后询问用户是否继续下一部分
   - 保持术语和风格的一致性
5. **合并结果**：所有部分翻译完成后，可选择合并为完整文档

### 4. 翻译风格

- 使用正式、学术的中文表达
- 保持原文的技术准确性
- 长句适当拆分，符合中文阅读习惯
- 专有名词首次出现时可保留英文原文（如：虚拟内存 (Virtual Memory)）

### 5. 异常处理

当遇到以下情况时，**跳过该部分**并在文档中添加标注：

1. **特殊 Unicode 字符**：文件包含无法正确处理的特殊字符（如乱码、不可见字符）
2. **格式严重损坏**：原文格式混乱，无法识别段落边界
3. **PDF 提取错误**：从 PDF 提取时产生的断行、错位等问题
4. **公式渲染问题**：数学公式无法正确解析

**标注格式**：
```markdown
<!-- [未翻译] 原因: {具体原因} -->
<!-- 原文开始 -->
{保留原文内容}
<!-- 原文结束 -->
```

**示例**：
```markdown
<!-- [未翻译] 原因: PDF提取导致公式格式损坏 -->
<!-- 原文开始 -->
B2Tw(⃗x) .= −xw−12w−1 +
<!-- 原文结束 -->
```

## 执行步骤

1. **读取文件**：读取 `$ARGUMENTS` 指定的文件
2. **统计行数**：计算文件总行数
3. **判断分割需求**：
   - 如果 ≤1000 行：直接按标题分段翻译
   - 如果 >1000 行：执行大文件分割流程
4. **大文件分割流程**（仅当 >1000 行时）：
   ```
   a. 计算分割数量 = min(ceil(总行数 / 1000), 10)
   b. 计算每部分的目标行数 = 总行数 / 分割数量
   c. 在每个目标分割点附近（±500行）寻找 ## 标题作为实际分割点
   d. 如果找不到 ## 标题，则在最近的空行处分割
   e. 将各部分保存为 raw_text/ 目录下的 _partN.md 文件
   f. 输出分割结果摘要，显示每个部分的行数范围
   ```
5. **逐部分翻译**：
   - 从第一部分开始翻译
   - 应用术语表确保一致性
   - 每完成一部分后询问：`继续翻译下一部分？(Y/n)`
6. **输出翻译结果**

## 分割示例

假设文件 `02-信息的表示和处理.md` 有 3000 行：

```
分割数量: ceil(3000/1000) = 3
每部分目标: 3000/3 = 1000 行

生成文件:
  - 02-信息的表示和处理_part1.md
  - 02-信息的表示和处理_part2.md
  - 02-信息的表示和处理_part3.md
```
